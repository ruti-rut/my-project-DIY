<div class="home-master-container">

  <!-- Loader -->
  @if (isLoading) {
    <div class="loader-container">
      <mat-spinner diameter="50" class="custom-spinner"></mat-spinner>
      <p>Building your creative space...</p>
    </div>
  } @else {

    <!-- 1. Hero / Welcome Banner -->
    <header class="home-hero">
      <h1 class="hero-title">Welcome to <span class="brand-text">creata</span></h1>
      <p class="hero-subtitle">Discover, Build, and Challenge yourself.</p>
    </header>

    <!-- 2. Active Challenges Section -->
    <section class="content-section challenges-section">
      <div class="section-header">
        <h2 class="section-title">
          <mat-icon class="icon-trophy">emoji_events</mat-icon>
          Live Challenges
        </h2>
        <a routerLink="/challenges" class="view-all-link">View All</a>
      </div>

      <div class="cards-grid">
        @for (c of challengeMap; track c.id) {
          <div class="challenge-card" [routerLink]="'/challenge/' + c.id">
            
            <!-- Image with Overlay -->
            <div class="card-image-wrapper">
              <img [src]="getImageUrl(c.picture)" [alt]="c.theme" class="card-img">
              <div class="live-badge">
                <span class="pulse-dot"></span> Live
              </div>
            </div>

            <div class="card-content">
              <h3 class="card-title">{{ c.theme }}</h3>
              
              <div class="meta-info">
                <mat-icon>schedule</mat-icon>
                <span>Ends: {{ formatDate(c.endDate) }}</span>
              </div>

              <button mat-flat-button class="btn-challenge-action">
                Join the Arena
              </button>
            </div>
          </div>
        }
      </div>
    </section>

    <!-- 3. Latest Projects Section -->
    <section class="content-section projects-section">
      <div class="section-header">
        <h2 class="section-title">
          <mat-icon class="icon-hammer">handyman</mat-icon>
          Latest Projects
        </h2>
      </div>

      @for (categoryGroup of projectsMap; track categoryGroup.key) {
        
        <div class="category-group">
          <h3 class="category-title">{{ getCategoryName(categoryGroup.key) }}</h3>

          <div class="cards-grid">
            @for (project of categoryGroup.value; track project.id) {
              <!-- Reusing your existing project card component -->
              <app-project-card [project]="project" class="grid-item"></app-project-card>
            }
          </div>
        </div>
      }
    </section>

  }
</div>