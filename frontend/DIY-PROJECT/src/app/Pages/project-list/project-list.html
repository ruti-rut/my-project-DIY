<div class="container">
  <!-- שורת חיפוש -->
  <div class="search-section">
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>חיפוש פרויקט או תגית</mat-label>
      <input
        matInput
        placeholder="הקלד שם פרויקט או תגית..."
        [formControl]="searchControl"
        autocomplete="off"
      />
      <mat-icon matPrefix>search</mat-icon>
      @if (searchControl.value) {
        <button mat-icon-button matSuffix (click)="clearSearch()">
          <mat-icon>close</mat-icon>
        </button>
      }
    </mat-form-field>
  </div>

  <!-- קטגוריות עם CHECKBOX -->
  <div class="categories-section">
    <label class="section-label">קטגוריות:</label>
    <div class="categories-checkboxes">
      @for (cat of categories(); track cat.id) {
        <mat-checkbox 
          [checked]="categoryControl.value?.includes(cat.id)"
          (change)="onCategoryToggle(cat.id)">
          {{ cat.name }}
        </mat-checkbox>
      }
      @if (categoryControl.value && categoryControl.value.length > 0) {
        <button mat-icon-button (click)="clearCategories()" class="clear-btn">
          <mat-icon>close</mat-icon>
        </button>
      }
    </div>
  </div>

  <!-- מיון -->
  <div class="sort-section">
    <mat-form-field appearance="outline" class="sort-field">
      <mat-label>מיון לפי</mat-label>
      <mat-select [formControl]="sortControl">
        <mat-option value="newest">מהחדש לישן</mat-option>
        <mat-option value="oldest">מהישן לחדש</mat-option>
        <mat-option value="popular">פופולריים</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <!-- רשימת פרויקטים -->
  <mat-grid-list [cols]="cols()" rowHeight="380px" gutterSize="16px">
    @for (project of projects(); track trackById($index, project)) {
      <mat-grid-tile>
        <app-project-card [project]="project"></app-project-card>
      </mat-grid-tile>
    }
  </mat-grid-list>

  <!-- כפתור טען עוד -->
  @if (hasMore()) {
    <div class="load-more">
      <button 
        mat-raised-button 
        color="primary" 
        (click)="loadMore()" 
        [disabled]="loading()">
        @if (loading()) {
          <mat-spinner diameter="20"></mat-spinner>
        } @else {
          טען עוד
        }
      </button>
    </div>
  }

  @if (!hasMore() && projects().length > 0) {
    <p class="no-more">אין עוד פרויקטים להצגה</p>
  }

  @if (!loading() && projects().length === 0) {
    <p class="no-results">לא נמצאו פרויקטים</p>
  }
</div>