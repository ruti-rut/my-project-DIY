<div class="spark-interface">
  
  <!-- Top Bar: Clean & Minimal -->
  <header class="spark-header">
    <div class="model-info">
      <div class="spark-logo-icon">
        <mat-icon>auto_awesome</mat-icon>
      </div>
      <div class="text-info">
        <span class="name">Spark AI</span>
        <span class="status">Creative Assistant</span>
      </div>
    </div>

    <div class="header-actions">
      <button mat-icon-button (click)="startNewChat()" matTooltip="New Conversation">
        <mat-icon>add</mat-icon>
      </button>
      <button mat-icon-button (click)="logout()" matTooltip="Close Session">
        <mat-icon>logout</mat-icon>
      </button>
    </div>
  </header>

  <!-- Chat Viewport -->
  <div class="chat-viewport" #scrollContainer>
    
    <!-- Empty State / Welcome Screen -->
    @if (messages().length === 0) {
      <div class="welcome-screen">
        <div class="hero-icon">
          <mat-icon>handyman</mat-icon>
        </div>
        <h2>What are we building today?</h2>
        <p>I can help you design furniture, fix appliances, or brainstorm creative gifts.</p>
        
        <!-- Quick Starter Chips -->
        <div class="suggestion-grid">
          <button class="chip" (click)="newMessage = 'How do I build a simple wooden shelf?'; send()">
            ğŸ”¨ Build a shelf
          </button>
          <button class="chip" (click)="newMessage = 'Fix a leaking faucet step-by-step'; send()">
            ğŸ’§ Fix a leak
          </button>
          <button class="chip" (click)="newMessage = 'Creative DIY gift ideas for mom'; send()">
            ğŸ Gift ideas
          </button>
          <button class="chip" (click)="newMessage = 'List of tools for a beginner carpenter'; send()">
            ğŸ§° Beginner Tools
          </button>
        </div>
      </div>
    }

    <!-- Message Stream -->
    <div class="message-stream">
      @for (msg of messages(); track msg.timestamp) {
        <app-message-bubble [message]="msg"></app-message-bubble>
      }

      <!-- Typing Indicator -->
      @if (isLoading()) {
        <div class="typing-indicator">
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
        </div>
      }
    </div>
  </div>

  <!-- Floating Input Area -->
  <div class="input-dock">
    <div class="input-capsule">
      <input 
        [(ngModel)]="newMessage"
        (keydown.enter)="handleEnter($event)"
        placeholder="Ask Spark anything..."
        [disabled]="isLoading()"
        autocomplete="off"
      />
      <button 
        class="btn-send" 
        (click)="send()" 
        [disabled]="!newMessage.trim() || isLoading()"
        [class.active]="newMessage.trim().length > 0">
        <mat-icon>arrow_upward</mat-icon>
      </button>
    </div>
    <div class="footer-note">
      Spark can make mistakes. Always check safety instructions before using tools.
    </div>
  </div>

</div>